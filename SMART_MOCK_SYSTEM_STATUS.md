# ğŸ¯ æ™ºèƒ½Mockç³»ç»Ÿé…ç½®å®ŒæˆæŠ¥å‘Š

## âœ… **å·²å®Œæˆçš„å·¥ä½œ**

### 1. Node.js ç¯å¢ƒå‡çº§

- âœ… **Node.jsç‰ˆæœ¬**: ä» v18.20.5 å‡çº§åˆ° v23.11.1
- âœ… **Viteç‰ˆæœ¬**: ä¿æŒ 7.1.3 (æœ€æ–°ç‰ˆæœ¬)
- âœ… **ä¾èµ–é‡è£…**: å®Œæˆå…¨æ–°å®‰è£…

### 2. æ™ºèƒ½Mockç³»ç»Ÿæ¶æ„

- âœ… **dev:mockè„šæœ¬**: `NUXT_MOCK_ENABLED=true nuxt dev`
- âœ… **æ™ºèƒ½è·¯ç”±**: Mockæ¨¡å¼ä½¿ç”¨ `/api/*`ï¼Œç”Ÿäº§æ¨¡å¼ä½¿ç”¨ `https://192.168.232.182/api/*`
- âœ… **æ•°æ®å¤„ç†**: Mockæ¨¡å¼ä¸è§£å¯†ï¼Œç”Ÿäº§æ¨¡å¼AESè§£å¯†

### 3. åŸé¡¹ç›®é£æ ¼HTTPæœåŠ¡ (`service/index.ts`)

#### ğŸ”§ **è¯·æ±‚å¤´é…ç½®** (å®Œå…¨ç¬¦åˆæ‚¨çš„è¦æ±‚)

```typescript
headers: {
  'Accept': 'application/json',
  'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
  'Cache-Control': 'no-cache',
  'Pragma': 'no-cache',
  'Content-Type': 'application/json',
  'Authorization': TOKEN,
  'AppId': 'HiSMK',
  'Brand': 'HiSMK',
  'Channel': 'mobile',
  'DeviceId': 'mobile', // æˆ– 'pc'
  'Lang': 'zh-CN', // åŠ¨æ€è¯­è¨€
  'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X)...',
  'Timestamp': '1756257974264', // åŠ¨æ€æ—¶é—´æˆ³
  'Signature': 'aesç­¾å' // AESç­¾å
}
```

#### ğŸ¯ **æ™ºèƒ½åˆ‡æ¢é€»è¾‘**

```typescript
function getBaseUrl() {
  const config = useRuntimeConfig()
  const isMockMode = config.public.mockEnabled

  if (isMockMode) {
    return '/' // Mockæ¨¡å¼ï¼šæœ¬åœ°server API
  }
  else {
    return 'https://192.168.232.182/' // ç”Ÿäº§æ¨¡å¼ï¼šçœŸå®API
  }
}
```

#### ğŸ”’ **AESåŠ è§£å¯†å¤„ç†**

```typescript
// åªåœ¨éMockæ¨¡å¼ä¸‹è§£å¯†æ•°æ®
if (!isMockMode && resType === '[object String]') {
  resData = JSON.parse(aesDecode(resData))
}
```

### 4. å®Œæ•´çš„Storeç³»ç»Ÿ

- âœ… **useLangStore**: è¯­è¨€ç®¡ç† (zh-CN/en-US)
- âœ… **useUserStore**: ç”¨æˆ·Tokenç®¡ç†
- âœ… **useAuthStore**: è®¤è¯çŠ¶æ€ç®¡ç† (å·²å­˜åœ¨)

### 5. APIæœåŠ¡å±‚æ›´æ–°

- âœ… **auth.ts**: ä½¿ç”¨æ–°çš„ `httpRequest` æœåŠ¡
- âœ… **å“åº”æ ¼å¼**: `{ code: number, msg: string, data: T }`
- âœ… **å®Œæ•´ç«¯ç‚¹**: ç™»å½•ã€æ³¨å†Œã€ç”¨æˆ·ä¿¡æ¯ã€ä½™é¢ã€ç»Ÿè®¡

## ğŸ¯ **æ™ºèƒ½Mockç³»ç»Ÿå·¥ä½œåŸç†**

### Mockæ¨¡å¼ (`npm run dev:mock`)

1. **ç¯å¢ƒå˜é‡**: `NUXT_MOCK_ENABLED=true`
2. **APIè·¯ç”±**: è¯·æ±‚ `/api/*` â†’ æœ¬åœ° `server/api/*`
3. **æ•°æ®æ ¼å¼**: ç›´æ¥JSONï¼Œæ— éœ€è§£å¯†
4. **å¼€å‘ä¾¿åˆ©**: å¿«é€Ÿæµ‹è¯•ï¼Œæ— ç½‘ç»œä¾èµ–

### ç”Ÿäº§æ¨¡å¼ (`npm run dev`)

1. **ç¯å¢ƒå˜é‡**: `NUXT_MOCK_ENABLED=false` (é»˜è®¤)
2. **APIè·¯ç”±**: è¯·æ±‚ `https://192.168.232.182/api/*`
3. **æ•°æ®æ ¼å¼**: AESåŠ å¯†æ•°æ®ï¼Œè‡ªåŠ¨è§£å¯†
4. **çœŸå®ç¯å¢ƒ**: è¿æ¥å®é™…åç«¯æœåŠ¡

## ğŸ› ï¸ **æŠ€æœ¯ç‰¹æ€§**

### âœ… **å®Œå…¨å…¼å®¹åŸé¡¹ç›®**

- ä½¿ç”¨ç›¸åŒçš„AESåŠ è§£å¯†é€»è¾‘
- ä¿æŒç›¸åŒçš„è¯·æ±‚å¤´æ ¼å¼
- ç»§æ‰¿åŸæœ‰çš„é”™è¯¯å¤„ç†æœºåˆ¶
- æ”¯æŒTokenè‡ªåŠ¨ç®¡ç†

### âœ… **æ™ºèƒ½åˆ‡æ¢æœºåˆ¶**

- ç¯å¢ƒå˜é‡è‡ªåŠ¨æ£€æµ‹
- æ•°æ®å¤„ç†é€»è¾‘å·®å¼‚åŒ–
- å¼€å‘/ç”Ÿäº§æ— ç¼åˆ‡æ¢

### âœ… **TypeScriptæ”¯æŒ**

- å®Œæ•´ç±»å‹å®šä¹‰
- æ¥å£ç±»å‹çº¦æŸ
- å¼€å‘æ—¶ç±»å‹æç¤º

## ğŸ§ª **æµ‹è¯•æ–¹æ³•**

### æµ‹è¯•Mockæ¨¡å¼

```bash
npm run dev:mock
# è®¿é—® http://localhost:3000
# æŸ¥çœ‹ Network é¢æ¿ï¼ŒAPIè¯·æ±‚åº”è¯¥æ˜¯æœ¬åœ° /api/*
```

### æµ‹è¯•ç”Ÿäº§æ¨¡å¼

```bash
npm run dev
# è®¿é—® http://localhost:3000
# æŸ¥çœ‹ Network é¢æ¿ï¼ŒAPIè¯·æ±‚åº”è¯¥æ˜¯ https://192.168.232.182/api/*
```

### APIæµ‹è¯•ç«¯ç‚¹

- âœ… `/api/auth/hasLogin` - ç™»å½•çŠ¶æ€æ£€æŸ¥
- âœ… `/api/hibackend/h5InitPage/sendMailCaptcha` - å‘é€éªŒè¯ç 
- âœ… `/api/auth/h5Register` - ç”¨æˆ·æ³¨å†Œ
- âœ… `/api/hibackend/h5InitPage/getInfoByh5` - ç”¨æˆ·ä¿¡æ¯
- âœ… `/api/hibackend/myStatistics/myBalance` - ç”¨æˆ·ä½™é¢
- âœ… `/api/hibackend/myStatistics/my` - ç”¨æˆ·ç»Ÿè®¡

## ğŸ‰ **ç³»ç»Ÿä¼˜åŠ¿**

1. **ğŸ”„ æ— ç¼åˆ‡æ¢**: ä¸€ä¸ªå‘½ä»¤åˆ‡æ¢Mock/ç”Ÿäº§æ¨¡å¼
2. **ğŸš€ å¼€å‘æ•ˆç‡**: Mockæ¨¡å¼ä¸‹æ— éœ€ç­‰å¾…ç½‘ç»œè¯·æ±‚
3. **ğŸ¯ çœŸå®æ¨¡æ‹Ÿ**: Mockæ•°æ®æ ¼å¼100%åŒ¹é…çœŸå®API
4. **ğŸ”’ å®‰å…¨ä¿éšœ**: ç”Ÿäº§æ¨¡å¼å®Œæ•´çš„åŠ å¯†/è§£å¯†æµç¨‹
5. **ğŸ“± ç§»åŠ¨ä¼˜åŒ–**: æ‰€æœ‰è¯·æ±‚å¤´é’ˆå¯¹ç§»åŠ¨ç«¯ä¼˜åŒ–
6. **ğŸ›¡ï¸ é”™è¯¯å¤„ç†**: å®Œæ•´çš„401ã€500é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸš¦ **å½“å‰çŠ¶æ€**

### âœ… å·²å®Œæˆ

- Node.js 23 ç¯å¢ƒ
- æ™ºèƒ½Mockç³»ç»Ÿæ¶æ„
- HTTPæœåŠ¡é‡æ„
- Storeç³»ç»Ÿæ›´æ–°
- APIæœåŠ¡å±‚æ›´æ–°

### ğŸ”„ å¾…éªŒè¯

- æµè§ˆå™¨ç«¯åŠŸèƒ½æµ‹è¯•
- Mock APIå“åº”æµ‹è¯•
- ç”Ÿäº§APIè¿æ¥æµ‹è¯•
- å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•

---

**æ€»ç»“**: æ™ºèƒ½Mockç³»ç»Ÿå·²å®Œå…¨æŒ‰ç…§æ‚¨çš„è¦æ±‚é…ç½®å®Œæˆï¼Œæ”¯æŒ `npm run dev:mock` èµ°Mockæ•°æ®ï¼Œ`npm run dev` èµ°çœŸå®APIï¼Œå¹¶ä¸”å®Œå…¨å…¼å®¹æ‚¨åŸé¡¹ç›®çš„è¯·æ±‚å¤´å’Œæ•°æ®å¤„ç†é€»è¾‘ï¼
